const questions71 = [
{
    "question": "Quel dispositif utilisait R√∂ntgen lors de sa d√©couverte des rayons X en 1895 ?",
    "answers": [
        {"text": "Un tube de Crookes entour√© de papier noir", "correct": true},
        {"text": "Une ampoule √† incandescence", "correct": false},
        {"text": "Un g√©n√©rateur √©lectrostatique", "correct": false},
        {"text": "Un microscope √©lectronique", "correct": false}
    ]
},
{
    "question": "Quelle est la principale utilisation des rayons X 'mous' ?",
    "answers": [
        {"text": "Le radiodiagnostic", "correct": true},
        {"text": "La radioth√©rapie", "correct": false},
        {"text": "La st√©rilisation", "correct": false},
        {"text": "La soudure m√©tallique", "correct": false}
    ]
},
{
    "question": "Quelle propri√©t√© des rayons X est exploit√©e en radioth√©rapie ?",
    "answers": [
        {"text": "Leur pouvoir de p√©n√©tration √©lev√© (rayons durs)", "correct": true},
        {"text": "Leur fluorescence visible", "correct": false},
        {"text": "Leur capacit√© √† ioniser l'air", "correct": false},
        {"text": "Leur r√©flexion sur les m√©taux", "correct": false}
    ]
},
{
    "question": "Pourquoi les effets biologiques des rayons X ne sont-ils pas imm√©diats ?",
    "answers": [
        {"text": "Ils n√©cessitent une p√©riode de latence", "correct": true},
        {"text": "Ils sont trop faibles pour √™tre d√©tect√©s", "correct": false},
        {"text": "Ils sont neutralis√©s par la peau", "correct": false},
        {"text": "Ils d√©pendent de la temp√©rature corporelle", "correct": false}
    ]
},
{
    "question": "Quel √©l√©ment du tube de Coolidge d√©termine la quantit√© de rayons X produits ?",
    "answers": [
        {"text": "Le filament de chauffage de la cathode", "correct": true},
        {"text": "La couleur du verre du tube", "correct": false},
        {"text": "La pression de l'air r√©siduel", "correct": false},
        {"text": "La forme de l'anode", "correct": false}
    ]
},
{
    "question": "Quel mat√©riau est couramment utilis√© pour prot√©ger contre les rayons X ?",
    "answers": [
        {"text": "Le plomb", "correct": true},
        {"text": "L'aluminium", "correct": false},
        {"text": "Le verre ordinaire", "correct": false},
        {"text": "Le cuivre", "correct": false}
    ]
},
{
    "question": "Quel ph√©nom√®ne permet de visualiser les organes en radioscopie ?",
    "answers": [
        {"text": "La fluorescence", "correct": true},
        {"text": "La r√©flexion des rayons", "correct": false},
        {"text": "L'√©chauffement des tissus", "correct": false},
        {"text": "La production d'ombres color√©es", "correct": false}
    ]
},
{
    "question": "Quelle est la principale diff√©rence entre les rayons X et la lumi√®re visible ?",
    "answers": [
        {"text": "La longueur d'onde", "correct": true},
        {"text": "La couleur", "correct": false},
        {"text": "La source de production", "correct": false},
        {"text": "La capacit√© √† chauffer les objets", "correct": false}
    ]
},
{
    "question": "Quel effet des rayons X est utilis√© pour mesurer leur dose ?",
    "answers": [
        {"text": "Leur pouvoir ionisant", "correct": true},
        {"text": "Leur fluorescence", "correct": false},
        {"text": "Leur r√©fraction", "correct": false},
        {"text": "Leur diffraction", "correct": false}
    ]
},
{
    "question": "Quelle pathologie est associ√©e √† une exposition chronique aux rayons X ?",
    "answers": [
        {"text": "La leuc√©mie", "correct": true},
        {"text": "Le diab√®te", "correct": false},
        {"text": "L'hypertension", "correct": false},
        {"text": "L'asthme", "correct": false}
    ]
},
{
    "question": "Quel facteur n'influence PAS l'absorption des rayons X par un mat√©riau ?",
    "answers": [
        {"text": "La couleur du mat√©riau", "correct": true},
        {"text": "Son nombre atomique", "correct": false},
        {"text": "Son √©paisseur", "correct": false},
        {"text": "Sa densit√©", "correct": false}
    ]
},
{
    "question": "Quelle est la source principale des rayons secondaires en radiologie ?",
    "answers": [
        {"text": "Le patient lui-m√™me", "correct": true},
        {"text": "Le tube √† rayons X", "correct": false},
        {"text": "L'air ambiant", "correct": false},
        {"text": "Les murs de la salle", "correct": false}
    ]
},
{
    "question": "Quel dispositif historique a pr√©c√©d√© le tube de Crookes ?",
    "answers": [
        {"text": "L'ampoule de Geissler", "correct": true},
        {"text": "Le microscope √©lectronique", "correct": false},
        {"text": "Le g√©n√©rateur Van de Graaff", "correct": false},
        {"text": "Le cyclotron", "correct": false}
    ]
},
{
    "question": "Que d√©montrent les exp√©riences de M√ºller sur les rayons X ?",
    "answers": [
        {"text": "Toute dose, m√™me minime, peut causer des mutations", "correct": true},
        {"text": "Seules les fortes doses sont dangereuses", "correct": false},
        {"text": "Les rayons X renforcent l'ADN", "correct": false},
        {"text": "Les effets sont r√©versibles", "correct": false}
    ]
},
{
    "question": "L'absorption des rayons X par un objet est proportionnelle √† :",
    "answers": [
        {"text": "La 4√®me puissance de son nombre atomique", "correct": true},
        {"text": "Sa temp√©rature", "correct": false},
        {"text": "Sa transparence √† la lumi√®re", "correct": false},
        {"text": "Son volume", "correct": false}
    ]
},
{
    "question": "Quel appareil mesure la dose de rayons X re√ßue par le personnel ?",
    "answers": [
        {"text": "Un dosim√®tre (badge)", "correct": true},
        {"text": "Un thermom√®tre", "correct": false},
        {"text": "Un st√©thoscope", "correct": false},
        {"text": "Un spectrom√®tre", "correct": false}
    ]
},
{
    "question": "Pourquoi utilise-t-on des gants en caoutchouc plomb√© ?",
    "answers": [
        {"text": "Pour bloquer les rayons secondaires", "correct": true},
        {"text": "Pour am√©liorer la conduction √©lectrique", "correct": false},
        {"text": "Pour √©viter les br√ªlures thermiques", "correct": false},
        {"text": "Pour r√©duire les co√ªts", "correct": false}
    ]
},
{
    "question": "Pourquoi place-t-on le tube √† 2 m du patient en t√©l√©radiographie ?",
    "answers": [
        {"text": "Pour obtenir des rayons quasi parall√®les", "correct": true},
        {"text": "Pour r√©duire la dose re√ßue", "correct": false},
        {"text": "Pour √©viter les br√ªlures", "correct": false},
        {"text": "Pour am√©liorer la r√©solution", "correct": false}
    ]
}
];


document.addEventListener('DOMContentLoaded', () => {
    const quiz71 = new QuizGame('quiz-container-71', questions71);
});


class QuizGame {
    constructor(containerId, questions) {
        this.container = document.getElementById(containerId);
        this.questions = questions;
        
        this.bestScoreDisplay = this.container.querySelector('.best-score-value');
        this.resetBestScoreBtn = this.container.querySelector('.reset-best-score-btn');
        this.startButton = this.container.querySelector('.start-btn');
        this.nextButton = this.container.querySelector('.next-btn');
        this.restartButton = this.container.querySelector('.restart-btn');
        this.startScreen = this.container.querySelector('.start-screen');
        this.quizContainer = this.container.querySelector('.quiz-container');
        this.resultsScreen = this.container.querySelector('.results-screen');
        this.questionElement = this.container.querySelector('.question');
        this.answerButtonsElement = this.container.querySelector('.answer-buttons');
        this.scoreTextElement = this.container.querySelector('.score-text');
        

        this.currentQuestionIndex = 0;
        this.score = 0;
        this.bestScore = localStorage.getItem(`bestScore_${containerId}`) ? 
                         parseInt(localStorage.getItem(`bestScore_${containerId}`)) : 0;
        
        this.init();
    }
    
    init() {

        this.updateBestScoreDisplay();
        

        this.startButton.addEventListener('click', () => this.startQuiz());
        this.nextButton.addEventListener('click', () => {
            this.currentQuestionIndex++;
            this.setNextQuestion();
        });
        this.restartButton.addEventListener('click', () => this.restartQuiz());
        this.resetBestScoreBtn.addEventListener('click', () => this.resetBestScore());
    }
    
    updateBestScoreDisplay() {
        this.bestScoreDisplay.textContent = ((this.bestScore / this.questions.length) * 100).toFixed(1);
    }
    
    startQuiz() {
        this.startScreen.classList.add('hide');
        this.quizContainer.classList.remove('hide');
        this.currentQuestionIndex = 0;
        this.score = 0;
        this.setNextQuestion();
    }
    
    setNextQuestion() {
        this.resetState();
        if (this.currentQuestionIndex < this.questions.length) {
            this.showQuestion(this.questions[this.currentQuestionIndex]);
        } else {
            this.showResults();
        }
    }
    
        showQuestion(question) {
            this.resetState();
            this.questionElement.innerText = question.question;
            
            const shuffledAnswers = this.shuffleArray([...question.answers]);
            
            shuffledAnswers.forEach(answer => {
                const button = document.createElement('button');
                button.innerText = answer.text;
                button.classList.add('btn', 'answer-btn');
                if (answer.correct) {
                    button.dataset.correct = answer.correct;
                }
                button.addEventListener('click', (e) => this.selectAnswer(e));
                this.answerButtonsElement.appendChild(button);
            });
        }
    
        shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }
    
    resetState() {
        this.nextButton.classList.add('hide');
        while (this.answerButtonsElement.firstChild) {
            this.answerButtonsElement.removeChild(this.answerButtonsElement.firstChild);
        }
    }
    
    selectAnswer(e) {
        const selectedButton = e.target;
        const correct = selectedButton.dataset.correct === 'true';
        
        selectedButton.classList.add('selected');
        
         Array.from(this.answerButtonsElement.children).forEach(button => {
           button.disabled = true;
            
        if (button === selectedButton) {
            if (correct) {
                button.classList.add('correct');
            } else {
                button.classList.add('incorrect');
                if (!correct) Array.from(this.answerButtonsElement.children).find(btn => btn.dataset.correct === 'true').classList.add('correct'); 
            }
        }
         });
        
        if (correct) {
            this.score++;
        }
        
        if (this.questions.length > this.currentQuestionIndex + 1) {
            this.nextButton.classList.remove('hide');
        } else {
            setTimeout(() => {
                this.showResults();
            }, 1500);
        }
    }
    
    showResults() {
        this.quizContainer.classList.add('hide');
        this.resultsScreen.classList.remove('hide');
        
        const percentage = (this.score / this.questions.length) * 100;
        let comment = "";
        
        if (percentage >= 80) {
            comment = "Tr√®s bien! Vous avez bien maitris√© cette le√ßon. R√©direction dans 5 secondes";   
            setTimeout(() => {
                window.location.href = "radiologie3/index.html";
            }, 5000);

        }else if (percentage >= 65 && percentage < 80) {
            comment = "Vous avez r√©ussi, mais la note minimale requise est de 80 √† plus."; 

        } else {
            comment = "Dommage! Peut-√™tre devriez-vous r√©viser un peu.";
        }
        
        let newRecord = false;
        if (this.score > this.bestScore) {
            this.bestScore = this.score;
            localStorage.setItem(`bestScore_${this.container.id}`, this.bestScore);
            newRecord = true;
        }
        
        this.updateBestScoreDisplay();
        
        this.scoreTextElement.innerHTML = `
            <p>Votre score: <strong>${percentage.toFixed(1)}%</strong></p>
            <p>Meilleur score: <strong>${((this.bestScore / this.questions.length) * 100).toFixed(1)}%</strong></p>
            <p>${comment} ${newRecord ? "üèÜ Nouveau record!" : ""}</p>
        `;
    }
    
    restartQuiz() {
        this.resultsScreen.classList.add('hide');
        this.startQuiz();
    }

    resetBestScore() {
        //  if (confirm("√ätes-vous s√ªr de vouloir r√©initialiser votre meilleur score ?")) {
        //      this.bestScore = 0;
        //      localStorage.setItem(`bestScore_${this.container.id}`, this.bestScore);
        //      this.updateBestScoreDisplay();
        //          alert("Meilleur score r√©initialis√© !");
        //  }
    }
}
